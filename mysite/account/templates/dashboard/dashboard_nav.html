{% extends "base.html" %}
{% load static %}
{% load tailwind_filters %}
{% block nav %}
    <nav class="nav-web-view p-[0.3rem] md:p-[0.3rem]  w-[100%] bg-[#fefefe] shadow fixed top-[0] z-[100]">
        <div class=" w-full flex items-center justify-between md:w-[80%] m-auto ">
            <div class="flex items-center cursor-pointer">
                <a href="{% url "home" %}" class="no-underline gap-[0.5rem] flex items-center">
                    <img src="{% static 'images/fitblog-logo.png' %}" height="64px" class="w-[30px] ">
                    <h4 class=" text-[#444444] ">FitBlog</h4>
                </a>
            </div>
            <div class="main-nav">
                <ul class="flex gap-[1.5rem] items-center">
                    <li>
                        <a class="flex items-center gap-[0.3rem] no-underline text-nowrap text-[#3b5361] font-medium" href="{% url "news-page" %}">
                            <i class="fa-regular fa-newspaper"></i>
                            News
                        </a>
                    </li>
                    <li>
                        <a class="flex items-center gap-[0.3rem] no-underline text-nowrap text-[#3b5361] font-medium" href="{% url "business-page" %}">
                            <i class="fa-solid fa-cart-shopping"></i>
                            Market Store
                        </a>
                    </li>
                    <li>
                        <a class="flex items-center gap-[0.3rem] no-underline text-nowrap text-[#3b5361] font-medium" href="{% url "music-page" %}">
                            <i class="fa-solid fa-music"></i>
                            Music
                        </a>
                    </li>
                </ul>
            </div>
            <div class="flex items-center md:order-2">
                <button id="postBtn" type="button" class="capitalize font-semibold text-[#3D5361] text-nowrap flex items-center" >
                    <i class="fa-solid fa-plus-circle mr-[5px]"></i>
                     Post
                </button>
                <div class="relative">
                    {% if user.is_authenticated %}
                        <button id="dropdownNavbarLink" data-dropdown-toggle="dropdownNavbar" class="cursor-pointer flex gap-[0.5rem] items-center text-[#3D5361] rounded-full py-[6px] px-[18px] text-[13px]  hover:text-[#3D5261] text-nowrap">
                            <img class="w-[40px] h-[40px] rounded-[50%] object-cover object-center mr-[10px]" src="{% static "images/default.png" %} " alt="Default Profile Image">
                        </button>
                        <!--ProfileModel-->
                        <div id="dropdownNavbar" class=" border border-slate-200 rounded-[15px] w-[250px] shadow-lg bg-slate-50 absolute right-0">
                            <div class="" aria-labelledby="dropdownLargeButton">
                                <div class="flex items-center gap-[1rem] border-b borer-slate-300 px-[1rem]">
                                    <div class="">
                                        {% if user.profilemodel.image %}
                                            <img class="w-[40px] h-[40px] border border-slate-200 rounded-[50%] object-cover object-center mr-[10px]" src=" {{ user.profilemodel.image.url }} " alt="Profile Image">
                                        {% else %}
                                            <img class="w-[40px] h-[40px] border border-slate-200 rounded-[50%] object-cover object-center mr-[10px]" src="{% static "images/default.png" %} " alt="Default Profile Image">
                                        {% endif %}
                                    </div>
                                    <div class="m-0 p-0">
                                        <h2 class="m-0 p-0 text-[#444444] font-medium">{{ user.profilemodel.full_name }}</h2>
                                        <small class='text-[0.8rem] text-[#555555]'>@{{ user.username }}</small>
                                    </div>
                                </div>
                                <div class="mt-[0.3rem]">
                                    <div class="">
                                        <a href="{% url "profile" %}" class="flex items-center gap-[1rem] text-[#555555] no-underline text-nowrap px-[1rem] py-[0.5rem] hover:bg-[#ebebeb]">
                                            <p> <i class="fa-solid fa-gear p_user"></i></p>
                                            <p class="">Manage account</p>
                                        </a>
                                    </div>
                                    <div class="">
                                        <a href="{% url "admin:index" %}" class="flex items-center gap-[1rem] text-[#555555] no-underline text-nowrap px-[1rem] py-[0.5rem] hover:bg-[#ebebeb]">
                                            <p> <i class="fa-solid fa-gears p_user"></i></p>
                                            <p class="">Admin</p>
                                        </a>
                                    </div>
                                    <div class="">
                                        <a href="{% url "user-dashboard" %}" class='flex gap-[1rem] items-center px-[1rem] py-[0.5rem] no-underline text-nowrap text-[#555555] hover:bg-[#ebebeb]'>
                                            <p> <i class="fa-solid fa-circle-user"></i></p>
                                            <p class="">Dashboard</p>
                                        </a>
                                    </div>
                                    <div class="">
                                        <a href="{% url "logout" %}" class='flex gap-[1rem] text-[#555555] no-underline text-nowrap items-center px-[1rem] py-[0.5rem] hover:bg-[#ebebeb]'>
                                            <p><i class="fa-solid fa-arrow-right-from-bracket"></i></p>
                                            <p class="">Sign out</p>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="flex items-center gap-[10px] w-full">
                            <a href="{% url "sign_up" %}" class=" rounded-full py-[6px] px-[18px] text-[13px] font-semibold text-[#3D5361] text-nowrap no-underline transition">
                                <i class="fa-solid fa-right-from-bracket mr-[3px]"></i>
                                Sign up
                            </a>
                            <a href="{% url "login" %}" class="rounded-full py-[6px] px-[18px] text-[#fefefefe] bg-[#3D5361] text-[13px] font-semibold text-nowrap no-underline transition">
                                <i class="fa-solid fa-right-from-bracket mr-[3px]"></i>
                                Login
                            </a>
                        </div>
                    {% endif %}
                </div>
                <button type="button" data-collapse-toggle="navbar-search" aria-controls="navbar-search" aria-expanded="false" class="md:hidden text-gray-500 dark:text-gray-400 hover:bg-gray-100  focus:outline-none focus:ring-4 focus:ring-gray-200  rounded-lg text-sm p-2.5 me-1">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18.031 16.617L22.314 20.899L20.899 22.314L16.617 18.031C15.0237 19.3082 13.042 20.0029 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20.0029 13.042 19.3082 15.0237 18.031 16.617ZM16.025 15.875C17.2938 14.5697 18.0025 12.8204 18 11C18 7.133 14.867 4 11 4C7.133 4 4 7.133 4 11C4 14.867 7.133 18 11 18C12.8204 18.0025 14.5697 17.2938 15.875 16.025L16.025 15.875Z" fill="currentColor"/>
                    </svg>
                    <span class="sr-only">Search</span>
                </button>
                <div class="relative hidden md:block">
                    <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18.031 16.617L22.314 20.899L20.899 22.314L16.617 18.031C15.0237 19.3082 13.042 20.0029 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20.0029 13.042 19.3082 15.0237 18.031 16.617ZM16.025 15.875C17.2938 14.5697 18.0025 12.8204 18 11C18 7.133 14.867 4 11 4C7.133 4 4 7.133 4 11C4 14.867 7.133 18 11 18C12.8204 18.0025 14.5697 17.2938 15.875 16.025L16.025 15.875Z" fill="currentColor"/>
                        </svg>
                        <span class="sr-only">Search icon</span>
                    </div>
                    <input type="text" id="search-navbar" class="block w-full p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 " placeholder="Search...">
                </div>
                <button data-collapse-toggle="navbar-search" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 " aria-controls="navbar-search" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
                    </svg>
                </button>
            </div>
        </div>
        <!--Mobile-responsive-->
        <div class="">
            <div class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1" id="navbar-search">
                <form method="get" action="" class="relative mt-3 md:hidden">
                    <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                        <svg class="w-4 h-4 text-gray-500 " aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
                        </svg>
                    </div>
                    <input type="search" name="search" id="search-navbar" class="block w-full p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Search...">
                </form>
                <ul class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:space-x-8 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
                    <li class="text-[#fefefe] border-b border-[#62879e4b] py-[1.2rem] px-[1rem] hover:bg-[#6a7f8d28]">
                        <i class="fa-regular fa-newspaper mr-[0.5rem]"></i>
                        <a class="no-underline text-[#fefefe] text-[15px]" href="{% url "news-page" %}">News</a>
                    </li>
                    <li class="text-[#fefefe] border-b border-[#62879e4b] py-[1.2rem] px-[1rem] hover:bg-[#6a7f8d28]">
                        <i class="fa-solid fa-cart-shopping mr-[0.5rem]"></i>
                        <a class="no-underline text-[#fefefe] text-[15px]" href="{% url "business-page" %}">Market Store</a>
                    </li>
                    <li class="text-[#fefefe] border-b border-[#62879e4b] py-[1.2rem] px-[1rem] hover:bg-[#6a7f8d28]">
                        <i class="fa-solid fa-music mr-[0.5rem]"></i>
                        <a class="no-underline text-[#fefefe] text-[15px]" href="{% url "music-page" %}">Music</a>
                    </li>
                    {% if not user.is_authenticated %}
                    <li class="text-[#fefefe] border-b border-[#62879e4b] py-[1.2rem] px-[1rem] hover:bg-[#6a7f8d28]">
                        <i class="fa-solid fa-user mr-[0.5rem]"></i>
                        <a class="no-underline text-[#fefefe] text-[15px]" href="{% url "login" %}">Sign In</a>
                    </li>
                    <li class="text-[#fefefe] border-b border-[#62879e4b] py-[1.2rem] px-[1rem] hover:bg-[#6a7f8d28]">
                        <i class="fa-solid fa-right-from-bracket mr-[0.5rem]"></i>
                        <a class="no-underline text-[#fefefe] text-[15px]" href="{% url "sign_up" %}">Sign Up</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
    
    <!-- Modal -->
    <div id="postModal" class="hidden fixed top-0 left-0 w-[100%] h-screen bg-[#000000] bg-opacity-20">
        <div class="w-[100%] md:w-[50%] m-auto fixed top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] bg-slate-50 shadow rounded-[1rem] ">
            <div class="modal-content p-[1.5rem]">
                <div class="flex justify-between items-center mb-[1rem]">
                    <h1 class="modal-title " id="exampleModalLabel">Create your Post <i class="fa-brands fa-blogger-b ml-[10px] mt-[3px]"></i></h1>
                    <button type="button" class="closeBtn cursor-pointer" >
                        <i class="fa-solid fa-close text-[22px]"></i>
                    </button>
                </div>
                <div class="modal-body mb-[2rem]">
                    <div class=" bg-[#ffffff8e] ">
                        <form action="" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ user_post_form|crispy }}
                            <div class="flex gap-[1rem] items-center my-[2rem] ">
                                <input type="submit" value="Post" class="py-[8px] cursor-pointer px-[18px]  rounded-full text-[#fefefefe] hover:bg-slate-500 bg-slate-600 w-full ">
                                <input type="button"  value="Cancel" class="closeBtn py-[8px] cursor-pointer px-[18px]  rounded-full text-[#3b5361] hover:bg-slate-50 border border-slate-400 w-full ">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Profile dropdown toggle
        document.addEventListener('DOMContentLoaded', function() {
            const profileTrigger2 = document.getElementById('profileTrigger2');
            const profileDropdown2 = document.getElementById('staticBackdrop2');

            profileTrigger2.addEventListener('click', function(e) {
                e.stopPropagation();
                profileDropdown2.classList.toggle('account2');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!profileDropdown2.contains(e.target)) {
                    profileDropdown2.classList.remove('account2');
                }
            });

             // Mobile menu
             const mobileMenu = document.getElementById('mobile_menu');
             const navLinks = document.getElementById('nav-links');
     
             mobileMenu.addEventListener('click', () => {
                 mobileMenu.classList.toggle('change');
                 navLinks.classList.toggle('showing');
                 // console.log('clicked');
             });
        });

        document.addEventListener('DOMContentLoaded', function() {
            const mobileListTrigger = document.getElementById('mobile-list-trigger');
            const activePlusDropUp = document.getElementById('activePlusDropUp');
            if (mobileListTrigger && activePlusDropUp) {
                mobileListTrigger.addEventListener('click', () => {
                    console.log('clicked on plus sign');
                    activePlusDropUp.classList.toggle('activePlusTrigger');
                    const plusIcon = mobileListTrigger.querySelector('i');
                    plusIcon.classList.toggle('fa-plus');
                    plusIcon.classList.toggle('fa-minus');
                });
            }
        });


         // Post Modal Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const postBtn = document.getElementById('postBtn');
            const postModal = document.getElementById('postModal');
            const closeBtns = document.querySelectorAll('.closeBtn');

            if (postBtn && postModal) {
                // Toggle modal on post button click
                postBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    postModal.classList.toggle('hidden');
                });
                 // Close modal on close buttons
                closeBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        postModal.classList.add('hidden');
                    });
                });
                // Close modal when clicking outside
                postModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        postModal.classList.add('hidden');
                    }
                });
            }
        });
    </script>
{% endblock %}